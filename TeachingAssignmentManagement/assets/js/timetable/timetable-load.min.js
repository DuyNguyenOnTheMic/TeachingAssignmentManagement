var rootUrl=$("#loader").data("request-url"),assignLecturerDiv=$("#assignLecturerDiv"),url=rootUrl+"Timetable/GetData",hubNotif=$.connection.timetableHub;function populateSelect(t){t.wrap('<div class="position-relative"></div>'),t.select2({language:"vi",dropdownAutoWidth:!0,dropdownParent:t.parent(),placeholder:t[0][0].innerHTML,allowClear:!0})}function updateClass(t,a,e){t.attr("data-lecturerid",a);var n=t.data("classtype");t.removeClass("btn-success btn-warning btn-secondary unassigned-theory unassigned-practical"),a?("Lý thuyết"==n?t.addClass("btn-success"):t.addClass("btn-warning"),e=splitString(e)):(e="Chưa phân","Lý thuyết"==n?t.addClass("btn-secondary unassigned-theory"):t.addClass("btn-secondary unassigned-practical")),t.text(e),$('[data-bs-toggle="popover"]').popover("update")}function updateCount(){var t=$("#assignedCount"),a=$("#totalCount"),e=$("#tblAssign tbody .assign-card"),n=$("#tblAssign tbody .btn-success"),s=$("#tblAssign tbody .btn-warning");t.text(n.length+s.length),a.text(e.length)}function getTimetable(t,a){$("#tblAssign [data-bs-toggle='tooltip']").tooltip("dispose"),$("#tblAssign [data-bs-toggle='popover']").popover("dispose"),t&&a&&(assignLecturerDiv.html('<div class="d-flex justify-content-center mt-2"><div class="spinner-border text-primary me-1" role="status"><span class="visually-hidden">Loading...</span></div><p class="my-auto">Đang tải...</p></div>'),$.get(url,{termId:t,majorId:a},(function(t){assignLecturerDiv.html(t)})))}$.connection.hub.start(),hubNotif.client.updatedData=function(t,a,e,n){var s=$("#"+t);s.length&&(n?updateClass(s,a,e):(s.parent().tooltip("dispose"),s.popover("dispose"),s.remove()),updateCount())},hubNotif.client.refreshedData=function(t,a){t==termId&&a==majorId?getTimetable(t,a):t==termId&&-1==majorId&&getTimetable(t,a=-1)},$((function(){var t=$(".form-select");t.each((function(){var t=$(this);t.val(t.find("option:first").next().val())})),$("#major option:first").after('<option value="-1">Tất cả</option>'),t.each((function(){var t=$(this);t.wrap('<div class="position-relative"></div>'),t.select2({language:"vi",dropdownAutoWidth:!0,dropdownParent:t.parent(),placeholder:t[0][0].innerHTML})})),t.change((function(){var t=$("#term").val(),a=$("#major").val();t&&a?getTimetable(t,a):assignLecturerDiv.html('<h4 class="text-center mt-2">Chưa có dữ liệu học kỳ</h4><div class="card-body"><img class="mx-auto p-3 d-block w-50" alt="No data" src="'+rootUrl+'assets/images/img_no_data.svg"></div>')})).change()}));