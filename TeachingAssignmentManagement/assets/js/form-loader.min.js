var profileForm=$("#profile-form"),majorForm=$("#major-form"),termForm=$("#term-form"),userForm=$("#user-form");$("#btnClose").click((function(){$(".ui-dialog-titlebar-close").click()}));var regexpId="^[a-zA-Z0-9_-]*$";if(jQuery.validator.addMethod("idCheck",(function(n,e){var t=new RegExp(regexpId);return this.optional(e)||t.test(n)})),profileForm.length&&profileForm.validate({rules:{staff_id:{idCheck:!0,maxlength:50},full_name:{maxlength:255}},messages:{staff_id:{idCheck:"Chỉ được nhập số-chữ không dấu và không có khoảng trắng!",maxlength:"Tối đa 50 kí tự được cho phép"},full_name:{maxlength:"Tối đa 255 kí tự được cho phép"}},submitHandler:function(n,e){e.preventDefault();var t=$(n).attr("action"),a=$(n).attr("method"),i=$(n).serialize();return $.ajax({url:t,type:a,data:i,success:function(n){$("input").blur(),n.success?Swal.fire({title:"Thông báo",text:n.message,icon:"success",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}):Swal.fire({title:"Thông báo",text:n.message,icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}}),!1}}),majorForm.length&&majorForm.validate({rules:{id:{required:!0,idCheck:!0,maxlength:50},name:{required:!0,maxlength:255},abbreviation:{required:!0,maxlength:50}},messages:{id:{required:"Bạn chưa nhập mã ngành",idCheck:"Chỉ được nhập số-chữ không dấu và không có khoảng trắng!",maxlength:"Tối đa 50 kí tự được cho phép"},name:{required:"Bạn chưa nhập tên ngành",maxlength:"Tối đa 255 kí tự được cho phép"},abbreviation:{required:"Bạn chưa nhập tên viết tắt của ngành",maxlength:"Tối đa 50 kí tự được cho phép"}}}),termForm.length){var yearSelect=$(".select2"),picker=$(".picker");function getMin(n){return n.hasClass("touchspin-startweek")?1:n.hasClass("touchspin-maxlesson")?3:n.hasClass("touchspin-maxclass")?1:void 0}function getMax(n){return n.hasClass("touchspin-startweek")?52:n.hasClass("touchspin-maxlesson")?15:n.hasClass("touchspin-maxclass")?30:void 0}yearSelect.each((function(){var n=$(this);n.wrap('<div class="position-relative"></div>'),n.select2({dropdownAutoWidth:!0,dropdownParent:n.parent(),minimumResultsForSearch:1/0}).change((function(){$("#start_year").val()<=$("#end_year").val()&&$(this).valid()}))})),$(".touchspin").each((function(){var n=$(this);n.TouchSpin({min:getMin(n),max:getMax(n),buttondown_txt:feather.icons.minus.toSvg(),buttonup_txt:feather.icons.plus.toSvg()}).on("touchspin.on.startdownspin",(function(){$(".bootstrap-touchspin-up").removeClass("disabled-max-min"),n.val()==getMin(n)&&$(this).siblings().find(".bootstrap-touchspin-down").addClass("disabled-max-min")})).on("touchspin.on.startupspin",(function(){$(".bootstrap-touchspin-down").removeClass("disabled-max-min"),n.val()==getMax(n)&&$(this).siblings().find(".bootstrap-touchspin-up").addClass("disabled-max-min")}))}));var vn={weekdays:{shorthand:["CN","T2","T3","T4","T5","T6","T7"],longhand:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"]},months:{shorthand:["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],longhand:["Tháng một","Tháng hai","Tháng ba","Tháng tư","Tháng năm","Tháng sáu","Tháng bảy","Tháng tám","Tháng chín","Tháng mười","Tháng mười một","Tháng mười hai"]},firstDayOfWeek:1};function toDate(n){var e=$(n).val().split("/");return 1===e.length?null:new Date(e[2],e[1]-1,e[0])}picker.flatpickr({locale:vn,altInput:!0,altFormat:"j F, Y",defaultDate:toDate("#start_date"),parseDate:(n,e)=>new Date(n.replace(/(\d{2})-(\d{2})-(\d{4})/,"$1/$2/$3")),onReady:function(n,e,t){t.isMobile&&$(t.mobileInput).attr("step",null)}}),picker.change((function(){$(this).valid()})),jQuery.validator.addMethod("moreCheck",(function(n,e,t){return this.optional(e)||parseInt(n)>=parseInt($(t).val())})),termForm.validate({ignore:[],rules:{id:{required:!0,digits:!0,number:!1,minlength:3,maxlength:3},start_date:{required:!0},end_year:{moreCheck:"#start_year"},start_week:{required:!0,number:!1,min:1,max:52},max_lesson:{required:!0,number:!1,min:3,max:15},max_class:{required:!0,number:!1,min:1,max:30}},messages:{id:{required:"Bạn chưa nhập học kỳ",digits:"Vui lòng nhập số!",minlength:"Vui lòng nhập đúng 3 kí tự!",maxlength:"Vui lòng nhập đúng 3 kí tự!"},start_date:{required:"Bạn chưa chọn ngày bắt đầu"},end_year:{moreCheck:"Năm kết thúc không thể nhỏ hơn năm bắt đầu!"},start_week:{required:"Bạn chưa nhập tuần bắt đầu",min:"Vui lòng nhập lớn hoặc bằng 1",max:"Vui lòng nhập nhỏ hơn hoặc bằng 52"},max_lesson:{required:"Bạn chưa nhập số tiết tối đa",min:"Vui lòng nhập lớn hoặc bằng 3",max:"Vui lòng nhập nhỏ hơn hoặc bằng 15"},max_class:{required:"Bạn chưa nhập số lớp tối đa",min:"Vui lòng nhập lớn hoặc bằng 1",max:"Vui lòng nhập nhỏ hơn hoặc bằng 30"}},errorPlacement:function(n,e){e.hasClass("select2")?n.insertAfter(e.siblings(".select2")):e.hasClass("picker")?n.insertAfter(e.siblings(".picker")):e.hasClass("touchspin")?n.insertAfter(e.closest(".bootstrap-touchspin")):n.insertAfter(e)}})}if(userForm.length){var select=$(".form-data");select.each((function(){var n=$(this);n.wrap('<div class="position-relative"></div>'),n.select2({placeholder:n[0][0].innerHTML,minimumResultsForSearch:1/0,forceabove:!0,dropdownParent:n.parent()}).change((function(){$(this).valid()}))}));var email_domain=["vlu.edu","vanlanguni"],regexpEmail="^[A-Za-z0-9._%+-]+@("+email_domain[0]+"|"+email_domain[1]+").vn$";jQuery.validator.addMethod("emailCheck",(function(n,e){var t=new RegExp(regexpEmail);return this.optional(e)||t.test(n)})),userForm.validate({rules:{staff_id:{required:!0,idCheck:!0,maxlength:50},full_name:{required:!0,maxlength:255},email:{required:function(){return"CH"==$("#type").val()},emailCheck:!0},type:{required:!0},role_id:{required:!0}},messages:{staff_id:{required:"Bạn chưa nhập mã giảng viên",idCheck:"Chỉ được nhập số-chữ không dấu và không có khoảng trắng!",maxlength:"Tối đa 50 kí tự được cho phép"},full_name:{required:"Bạn chưa nhập tên giảng viên",maxlength:"Tối đa 255 kí tự được cho phép"},email:{required:"Bạn chưa nhập email",emailCheck:"Vui lòng nhập email Văn Lang hợp lệ!"},type:{required:"Bạn chưa chọn loại giảng viên"},role_id:{required:"Bạn chưa chọn role"}},errorPlacement:function(n,e){e.hasClass("form-data")?n.insertAfter(e.siblings(".select2")):n.insertAfter(e)}})}