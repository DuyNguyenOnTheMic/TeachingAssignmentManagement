var rootUrl=$("#loader").data("request-url");function splitString(t){return t.substring(0,t.lastIndexOf(" ")).split(" ").map(function(t){return t[0]}).join(".")+" "+t.split(" ").pop()}function changeLecturer(t){t.select2("destroy").unwrap();var e=t.find(":selected"),s=e.val(),a=e.text(),n=splitString(a);""!=s&&e.text(n);var c=t.data("preval"),i=t.data("pretext");t.children('option[value = "'+c+'"]').text(i),t.data("preval",s),t.data("pretext",a),populateSelect(t)}$(function(){0==$("#tblAssign tbody tr").length?$("#assignLecturerDiv").append('<h4 class="text-center mt-2">Học kỳ này chưa có dữ liệu <i class="feather feather-help-circle"></i></h4>'):($("table .form-select").each(function(){populateSelect($(this))}),Waves.init(),Waves.attach(".btn-assign",["waves-float","waves-light"]),$('[data-bs-toggle="tooltip"]').tooltip({trigger:"hover"}))}),$("table .form-select option:selected").each(function(){var t=$(this);if(""!=t.val()){t.closest(".form-select").attr("data-preval",t.val()),t.closest(".form-select").attr("data-pretext",t.text());var e=splitString(t.text());$(this).text(e)}else t.closest(".assign-card").addClass("bg-opacity-50")}),$("table .form-select").on("select2:select select2:unselecting",function(){changeLecturer($(this))}),$(".btn-assign").on("click",function(){$this=$(this);var t=$this.closest(".assign-card").attr("id"),e=$this.parent().find(".select2 :selected").val();$.ajax({type:"POST",url:rootUrl+"FacultyBoard/Timetable/Assign",data:{id:t,lecturerId:e},success:function(t){if(t.success){var s=$this.closest(".assign-card");""==e?s.addClass("bg-opacity-50"):s.hasClass("bg-opacity-50")&&s.removeClass("bg-opacity-50"),toastr.options.positionClass="toast-bottom-right",toastr.success("Thành công!")}}})}),$(".btn-delete").on("click",function(){$this=$(this);var t=$this.closest(".assign-card").attr("id");Swal.fire({title:"Thông báo",text:"Bạn có chắc muốn xoá lớp học phần này?",icon:"warning",showCancelButton:!0,confirmButtonText:"Xoá",cancelButtonText:"Huỷ",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-outline-danger ms-1"},buttonsStyling:!1}).then(e=>{e.isConfirmed&&$.ajax({type:"POST",url:rootUrl+"FacultyBoard/Timetable/Delete",data:{id:t},success:function(t){t.success&&(toastr.options.positionClass="toast-bottom-right",toastr.success("Xoá lớp thành công!"))}})})});