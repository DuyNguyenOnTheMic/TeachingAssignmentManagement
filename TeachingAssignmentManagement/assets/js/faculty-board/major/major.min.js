var popup,dataTable,rootUrl=$("#loader").data("request-url");function refreshTable(){dataTable.ajax.reload(null,!1)}function disableButtons(t){!0===t?($(".createNew").prop("disabled",!0),$(".editRow").each((function(){this.style.pointerEvents="none"})),$(".deleteRow").each((function(){this.style.pointerEvents="none"}))):($(".createNew").prop("disabled",!1),$(".editRow").each((function(){this.style.pointerEvents="auto"})),$(".deleteRow").each((function(){this.style.pointerEvents="auto"})))}function popupForm(t){var e=$("<div/>");$.get(t).done((function(t){e.html(t),popup=e.dialog({autoOpen:!0,resizable:!1,title:"Quản lý ngành học",width:550,open:function(){$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").addClass("btn-close"),disableButtons(!0)},close:function(){popup.dialog("destroy").remove(),disableButtons(!1)}})}))}function submitForm(t){return $.validator.unobtrusive.parse(t),$(t).valid()&&$.ajax({type:"POST",url:t.action,data:$(t).serialize(),success:function(t){t.success?(popup.dialog("close"),refreshTable(),toastr.options.positionClass="toast-bottom-right",toastr.success(t.message)):Swal.fire({title:"Thông báo",text:"Mã ngành này đã tồn tại!",icon:"error",customClass:{confirmButton:"btn btn-primary"}})}}),!1}function deleteMajor(t){Swal.fire({title:"Thông báo",text:"Bạn có chắc muốn xoá ngành này?",icon:"warning",showCancelButton:!0,cancelButtonText:"Huỷ",confirmButtonText:"Xoá",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-outline-danger ms-1"}}).then((e=>{e.isConfirmed&&$.ajax({type:"POST",url:rootUrl+"FacultyBoard/Major/Delete/"+t,success:function(t){t.success?(refreshTable(),toastr.options.positionClass="toast-bottom-right",toastr.success(t.message)):Swal.fire({title:"Thông báo",text:"Không thể xoá do đã có sinh viên học ngành này!",icon:"error",customClass:{confirmButton:"btn btn-primary"}})}})}))}$((function(){"use strict";var t=$.connection.majorHub;$.connection.hub.start(),t.client.updatedData=function(){refreshTable()},(dataTable=$("#tblMajor").DataTable({ajax:{url:rootUrl+"FacultyBoard/Major/GetData",type:"GET",dataType:"json",dataSrc:""},deferRender:!0,columns:[{data:"",defaultContent:""},{data:"id"},{data:"name"},{data:"id",render:function(t){return"<a class='editRow text-success p-0' data-original-title='Edit' title='Edit' onclick=popupForm('"+rootUrl+"FacultyBoard/Major/Edit/"+t+"')><i class='feather feather-edit font-medium-3 me-1'></i></a> <a class='deleteRow text-danger p-0' data-original-title='Delete' title='Delete' onclick=deleteMajor('"+t+"') > <i class='feather feather-trash-2 font-medium-3 me-1'></i></a > "}}],columnDefs:[{searchable:!1,orderable:!1,className:"text-center",targets:[0,3]},{width:"5%",targets:0},{width:"10%",targets:3}],order:[[1,"asc"]],dom:'<"d-flex justify-content-between align-items-center header-actions mx-2 row mt-75"<"col-sm-12 col-lg-4 d-flex justify-content-center justify-content-lg-start" l><"col-sm-12 col-lg-8 ps-xl-75 ps-0"<"dt-action-buttons d-flex align-items-center justify-content-center justify-content-lg-end flex-lg-nowrap flex-wrap"<"me-1"f>B>>>t<"d-flex justify-content-between mx-2 row mb-1"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',displayLength:7,lengthMenu:[7,10,25,50,75,100],buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle me-2",text:feather.icons.share.toSvg({class:"font-small-4 me-50"})+"Export",buttons:[{extend:"print",className:"dropdown-item"},{extend:"csv",className:"dropdown-item"},{extend:"excel",className:"dropdown-item",title:"",customize:function(t){var e=t.xl.worksheets["sheet1.xml"];$("row:first c",e).attr("s","42")}},{extend:"pdf",className:"dropdown-item"},{extend:"copy",className:"dropdown-item"}],init:function(t,e,o){$(e).removeClass("btn-secondary"),$(e).parent().removeClass("btn-group"),setTimeout((function(){$(e).closest(".dt-buttons").removeClass("btn-group").addClass("d-inline-flex mt-50")}),50)}},{text:feather.icons.plus.toSvg({class:"me-50 font-small-4"})+"Thêm ngành mới",className:"createNew btn btn-primary",attr:{onclick:"popupForm('"+rootUrl+"FacultyBoard/Major/Create')"}}],language:{url:rootUrl+"app-assets/language/vi.json"}})).on("draw.dt",(function(){dataTable.column(0,{search:"applied",order:"applied"}).nodes().each((function(t,e){t.innerHTML=e+1,dataTable.cell(t).invalidate("dom")})),!0===$(".ui-dialog-content").dialog("isOpen")&&disableButtons(!0)}))}));