var termId=$("#term").val(),weekData=$("#weekData"),startWeek=weekData.data("start-week"),endWeek=weekData.data("end-week"),currentWeek=weekData.data("current-week"),rootUrl=$("#loader").data("request-url"),lecturerFilter=$("#lecturerFilter"),classCount=$("#tblStatistics .class-card").length;if(0==classCount)$("#timetableStatisticsDiv").empty().append('<h4 class="text-center mt-2">Chưa có dữ liệu <i class="feather feather-help-circle"></i></h4><div class="card-body"><img class="mx-auto p-3 d-block w-50" alt="Welcome" src="'+rootUrl+'assets/images/img_no_data.svg"></div>');else{$('#tblStatistics [data-bs-toggle="tooltip"]').tooltip({trigger:"hover"});var popoverTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')),popoverList=popoverTriggerList.map((function(e){return new bootstrap.Popover(e,{html:!0,sanitize:!1})}));$("#tblStatistics tbody tr").hide()}if(!weekSelect.val())if(startWeek<=endWeek){for(var i=startWeek;i<=endWeek;i++)weekSelect.append('<option value="'+i+'">Tuần '+i+"</option>");weekSelect.val(currentWeek)}else timetableStatisticsDiv.empty().append('<h4 class="text-center mt-2">Oops, có vẻ như ban chủ nhiệm khoa của bạn đã đặt tuần bắt đầu lớn hơn tuần kết thúc, vui lòng liên hệ để sửa lỗi.</h4><div class="card-body"><img class="mx-auto p-3 d-block w-50" alt="Welcome" src="'+rootUrl+'assets/images/img_sorry.svg"></div>'),weekSelect.parent().find(".select2-selection__placeholder").text("không khả dụng");function filterCount(e){e.parent().find(".select2-search__field").attr("placeholder","Đã chọn "+e.val().length+" GV")}$.fn.select2.amd.define("select2/selectAllAdapter",["select2/utils","select2/dropdown","select2/dropdown/attachBody"],(function(e,t,r){function l(){}return l.prototype.render=function(e){var t=this,r=e.call(this),l=$('<button class="btn btn-sm text-start filter-button" type="button"><i class="feather feather-check-square"></i> Chọn tất cả</button>'),a=$('<button class="btn btn-sm text-start filter-button" type="button"><i class="feather feather-square"></i> Bỏ chọn tất cả</button>'),n=$('<div class="d-grid"></div>').append(l).append(a);return this.$element.prop("multiple")?(r.find(".select2-dropdown").prepend(n),l.on("click",(function(){lecturerFilter.find("option").prop("selected","selected").trigger("change"),filterCount(lecturerFilter),t.trigger("close"),$("#tblStatistics").find("tbody tr").show()})),a.on("click",(function(){lecturerFilter.val("-1").trigger("change"),lecturerFilter.parent().find(".select2-search__field").attr("placeholder","Lọc giảng viên"),t.trigger("close"),$("#tblStatistics").find("tbody tr").hide()})),r):r},e.Decorate(e.Decorate(t,r),l)})),lecturerFilter.wrap('<div class="position-relative my-50"></div>'),lecturerFilter.select2({language:"vi",dropdownAutoWidth:!0,dropdownParent:lecturerFilter.parent(),dropdownAdapter:$.fn.select2.amd.require("select2/selectAllAdapter")}),lecturerFilter.parent().find(".select2-search__field").attr("placeholder","Lọc giảng viên"),lecturerFilter.on("select2:select",(function(e){$("#"+e.params.data.id).show(),filterCount(lecturerFilter)})).on("select2:unselect",(function(e){$("#"+e.params.data.id).hide(),filterCount(lecturerFilter)})),$((function(){"use strict";var e=$("#tour");e.length&&e.on("click",(function(){var e,t,r,l=new Shepherd.Tour({defaultStepOptions:{classes:"shadow-md bg-purple-dark",scrollTo:!1,cancelIcon:{enabled:!0}},useModalOverlay:!0});(e=l,t="btn btn-sm btn-outline-primary",r="btn btn-sm btn-primary btn-next",e.addStep({title:"Chọn tuần",text:"Bạn có thể chọn tuần để xem TKB ờ đây. Mặc định hệ thống sẽ chọn tuần hiện tại.",attachTo:{element:"#week + .select2-container",on:"bottom"},buttons:[{action:e.cancel,classes:t,text:"Bỏ qua"},{text:"Tiếp",classes:r,action:e.next}]}),e.addStep({title:"Lọc giảng viên",text:"Chọn giảng viên bạn muốn xem TKB ở đây.",attachTo:{element:"#lecturerFilter + .select2-container",on:"bottom"},buttons:[{text:"Quay lại",classes:t,action:e.back},{text:"OK",classes:r,action:e.cancel}]}),e).start()}))}));