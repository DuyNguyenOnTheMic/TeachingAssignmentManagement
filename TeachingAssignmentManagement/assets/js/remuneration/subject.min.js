var popup,dataTable,dataLoader=$("#data-loader"),termId=dataLoader.data("termid"),majorId=dataLoader.data("majorid");function setVisibleColumn(t){var e=$("#tblSubject").DataTable();e.column(4).visible(t,t),e.columns.adjust().draw(t)}function disableButtons(t){!0===t?($(".editAll").prop("disabled",!0),$(".editRow").each((function(){this.style.pointerEvents="none"}))):($(".editAll").prop("disabled",!1),$(".editRow").each((function(){this.style.pointerEvents="auto"})))}function popupForm(t){var e=$("<div/>");$.get(t).done((function(t){e.html(t),popup=e.dialog({autoOpen:!0,resizable:!1,title:"Quản lý thù lao môn học",width:550,open:function(){$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").addClass("btn-close"),disableButtons(!0)},close:function(){popup.dialog("destroy").remove(),disableButtons(!1)}})}))}function submitForm(t){return $.validator.unobtrusive.parse(t),$(t).valid()&&$.ajax({type:"POST",url:t.action,data:$(t).serialize(),success:function(t){t.success?(popup.dialog("close"),dataTable.ajax.reload(null,!1),toastr.success(t.message)):Swal.fire({title:"Thông báo",text:t.message,icon:"error",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}}),!1}$((function(){(dataTable=$("#tblSubject").DataTable({ajax:{url:rootUrl+"Remuneration/GetSubjectCoefficientData?termId="+termId+"&majorId="+majorId,type:"GET",dataType:"json",dataSrc:""},deferRender:!0,columns:[{data:"",defaultContent:""},{data:"subject_id"},{data:"name"},{data:"credits"},{data:"major",defaultContent:""},{data:"is_vietnamese"},{data:"theoretical_coefficient"},{data:"practice_coefficient"},{data:"id",render:function(t){return"<a class='editRow text-success p-0' data-original-title='Chỉnh sửa' title='Chỉnh sửa' onclick=popupForm('"+rootUrl+"Remuneration/EditSubjectCoefficient/"+t+"')><i class='feather feather-edit font-medium-3 me-1'></i></a>"}}],columnDefs:[{targets:5,render:function(t){return t?'<i class="flag-icon flag-icon-vn me-50"></i>Việt':'<i class="flag-icon flag-icon-us me-50"></i>Anh'}},{searchable:!1,orderable:!1,targets:[0,8]},{className:"text-center",targets:[0,3,5,6,7,8]},{width:"5%",targets:0},{width:"10%",targets:8}],order:[[1,"asc"]],dom:'<"d-flex justify-content-between align-items-center header-actions mx-2 row mt-75"<"col-sm-12 col-lg-4 d-flex justify-content-center justify-content-lg-start" l><"col-sm-12 col-lg-8 ps-xl-75 px-0"<"dt-action-buttons d-flex align-items-center justify-content-center justify-content-lg-end flex-lg-nowrap flex-wrap"<"me-1"f>B>>>t<"d-flex justify-content-between mx-2 row mb-1"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',displayLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"tất cả"]],buttons:[{text:feather.icons["edit-2"].toSvg({class:"me-50 font-small-4"})+"Sửa tất cả",className:"editAll btn btn-primary",attr:{onclick:"popupForm('"+rootUrl+"Remuneration/EditAllSubjectCoefficients?termId="+termId+"&majorId="+majorId+"')"},init:function(t,e,a){$(e).removeClass("btn-secondary"),$(e).parent().removeClass("btn-group"),setTimeout((function(){$(e).closest(".dt-buttons").removeClass("btn-group").addClass("d-inline-flex mt-50")}),50)}}],initComplete:function(){setVisibleColumn("-1"==majorId)},language:{url:rootUrl+"app-assets/language/datatables/vi.json"}})).on("draw.dt",(function(){dataTable.column(0,{search:"applied",order:"applied"}).nodes().each((function(t,e){t.innerHTML=e+1})),!0===$(".ui-dialog-content").dialog("isOpen")?disableButtons(!0):disableButtons(!1)}))}));